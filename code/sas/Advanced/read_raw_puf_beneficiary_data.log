113  /********************************************************************
114  * Job Name: read_raw_puf_beneficiary_data.sas
115  * Job Desc: code to read raw txt which is puf prescription sample
116  * COPYRIGHT (c) 2019 2020 Johns Hopkins University - HutflessLab 2019
117  ********************************************************************/
118
119  %global  raw_data_path     ;
120  %global  raw_data_product  ;
121  %global  perm_lib          ;
122  %global  lwork             ;
123  %let     perm_lib          =synth          ;
124  %let     lwork             =work           ;
125
126  libname &perm_lib "C:\z_data\z_client_jhu\puf1";
NOTE: Libref SYNTH was successfully assigned as follows:
      Engine:        V9
      Physical Name: C:\z_data\z_client_jhu\puf1
127
128  %global  pat_id   ;
129  %let     pat_id   =desynpuf_id  ;
130
131  %macro read_in_raw_to_get_sasds(raw_in_data   = ,
132                                  local_out_ds  =
133                                  );
134     data &local_out_ds ;
135         infile "&raw_in_data"
136         delimiter = ',' MISSOVER DSD lrecl=32767 firstobs=2 ;
137         informat &pat_id                   $42.       ; format &pat_id                   $42.
137!   ;
138         informat bene_birth_dt             anydtdte21.; format bene_birth_dt             yymmdd10.
138!   ;
139         informat bene_death_dt             anydtdte21.; format bene_death_dt             yymmdd10.
139!   ;
140         informat bene_sex_ident_cd         $1.        ; format bene_sex_ident_cd         $1.
140!   ;
141         informat bene_race_cd              $1.        ; format bene_race_cd              $1.
141!   ;
142         informat bene_esrd_ind             $1.        ; format bene_esrd_ind             $1.
142!   ;
143         informat sp_state_code             $2.        ; format sp_state_code             $2.
143!   ;
144         informat bene_county_cd            $3.        ; format bene_county_cd            $3.
144!   ;
145         informat bene_hi_cvrage_tot_mons   best32.    ; format bene_hi_cvrage_tot_mons   best32.
145!   ;
146         informat bene_smi_cvrage_tot_mons  best32.    ; format bene_smi_cvrage_tot_mons  best32.
146!   ;
147         informat bene_hmo_cvrage_tot_mons  best32.    ; format bene_hmo_cvrage_tot_mons  best32.
147!   ;
148         informat plan_cvrg_mos_num         best32.    ; format plan_cvrg_mos_num         best32.
148!   ;
149         informat sp_alzhdmta               best32.    ; format sp_alzhdmta               best32.
149!   ;
150         informat sp_chf                    best32.    ; format sp_chf                    best32.
150!   ;
151         informat sp_chrnkidn               best32.    ; format sp_chrnkidn               best32.
151!   ;
152         informat sp_cncr                   best32.    ; format sp_cncr                   best32.
152!   ;
153         informat sp_copd                   best32.    ; format sp_copd                   best32.
153!   ;
154         informat sp_depressn               best32.    ; format sp_depressn               best32.
154!   ;
155         informat sp_diabetes               best32.    ; format sp_diabetes               best32.
155!   ;
156         informat sp_ischmcht               best32.    ; format sp_ischmcht               best32.
156!   ;
157         informat sp_osteoprs               best32.    ; format sp_osteoprs               best32.
157!   ;
158         informat sp_ra_oa                  best32.    ; format sp_ra_oa                  best32.
158!   ;
159         informat sp_strketia               best32.    ; format sp_strketia               best32.
159!   ;
160         informat medreimb_ip               best32.    ; format medreimb_ip               best32.
160!   ;
161         informat benres_ip                 best32.    ; format benres_ip                 best32.
161!   ;
162         informat pppymt_ip                 best32.    ; format pppymt_ip                 best32.
162!   ;
163         informat medreimb_op               best32.    ; format medreimb_op               best32.
163!   ;
164         informat benres_op                 best32.    ; format benres_op                 best32.
164!   ;
165         informat pppymt_op                 best32.    ; format pppymt_op                 best32.
165!   ;
166         informat medreimb_car              best32.    ; format medreimb_car              best32.
166!   ;
167         informat benres_car                best32.    ; format benres_car                best32.
167!   ;
168         informat pppymt_car                best32.    ; format pppymt_car                best32.
168!   ;
169      input
170            &pat_id                   $
171            bene_birth_dt
172            bene_death_dt
173            bene_sex_ident_cd         $
174            bene_race_cd              $
175            bene_esrd_ind             $
176            sp_state_code             $
177            bene_county_cd            $
178            bene_hi_cvrage_tot_mons
179            bene_smi_cvrage_tot_mons
180            bene_hmo_cvrage_tot_mons
181            plan_cvrg_mos_num
182            sp_alzhdmta
183            sp_chf
184            sp_chrnkidn
185            sp_cncr
186            sp_copd
187            sp_depressn
188            sp_diabetes
189            sp_ischmcht
190            sp_osteoprs
191            sp_ra_oa
192            sp_strketia
193            medreimb_ip
194            benres_ip
195            pppymt_ip
196            medreimb_op
197            benres_op
198            pppymt_op
199            medreimb_car
200            benres_car
201            pppymt_car
202      ;
203  run;
204
205
206  %mend; *** end of read_in_raw_to_get_sasds ;
207
208
209  %let     raw_data_path     = C:\z_data\z_client_jhu\puf1\;
210
211  %let     raw_data_product  = DE1_0_2008_Beneficiary_Summary_File_Sample_1.csv ;
212  %read_in_raw_to_get_sasds(raw_in_data   = &raw_data_path.&raw_data_product ,
213                            local_out_ds  = &perm_lib..Beneficiary_2008_sample_1
214                            );

NOTE: The infile "C:\z_data\z_client_jhu\puf1\DE1_0_2008_Beneficiary_Summary_File_Sample_1.csv" is:
      Filename=C:\z_data\z_client_jhu\puf1\DE1_0_2008_Beneficiary_Summary_File_Sample_1.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=14588413,
      Last Modified=26Nov2019:14:50:06,
      Create Time=13Dec2019:21:12:39

NOTE: 116352 records were read from the infile
      "C:\z_data\z_client_jhu\puf1\DE1_0_2008_Beneficiary_Summary_File_Sample_1.csv".
      The minimum record length was 115.
      The maximum record length was 148.
NOTE: The data set SYNTH.BENEFICIARY_2008_SAMPLE_1 has 116352 observations and 32 variables.
NOTE: DATA statement used (Total process time):
      real time           0.22 seconds
      cpu time            0.20 seconds


215
216  %let     raw_data_product  = DE1_0_2009_Beneficiary_Summary_File_Sample_1.csv ;
217  %read_in_raw_to_get_sasds(raw_in_data   = &raw_data_path.&raw_data_product ,
218                            local_out_ds  = &perm_lib..Beneficiary_2009_sample_1
219                            );

NOTE: The infile "C:\z_data\z_client_jhu\puf1\DE1_0_2009_Beneficiary_Summary_File_Sample_1.csv" is:
      Filename=C:\z_data\z_client_jhu\puf1\DE1_0_2009_Beneficiary_Summary_File_Sample_1.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=14494380,
      Last Modified=26Nov2019:14:50:38,
      Create Time=13Dec2019:21:13:01

NOTE: 114538 records were read from the infile
      "C:\z_data\z_client_jhu\puf1\DE1_0_2009_Beneficiary_Summary_File_Sample_1.csv".
      The minimum record length was 115.
      The maximum record length was 148.
NOTE: The data set SYNTH.BENEFICIARY_2009_SAMPLE_1 has 114538 observations and 32 variables.
NOTE: DATA statement used (Total process time):
      real time           0.22 seconds
      cpu time            0.18 seconds


220
221  %let     raw_data_product  = DE1_0_2010_Beneficiary_Summary_File_Sample_1.csv ;
222  %read_in_raw_to_get_sasds(raw_in_data   = &raw_data_path.&raw_data_product ,
223                            local_out_ds  = &perm_lib..Beneficiary_2010_sample_1
224                            );

NOTE: The infile "C:\z_data\z_client_jhu\puf1\DE1_0_2010_Beneficiary_Summary_File_Sample_1.csv" is:
      Filename=C:\z_data\z_client_jhu\puf1\DE1_0_2010_Beneficiary_Summary_File_Sample_1.csv,
      RECFM=V,LRECL=32767,File Size (bytes)=14083582,
      Last Modified=26Nov2019:14:50:18,
      Create Time=13Dec2019:21:13:02

NOTE: 112754 records were read from the infile
      "C:\z_data\z_client_jhu\puf1\DE1_0_2010_Beneficiary_Summary_File_Sample_1.csv".
      The minimum record length was 115.
      The maximum record length was 149.
NOTE: The data set SYNTH.BENEFICIARY_2010_SAMPLE_1 has 112754 observations and 32 variables.
NOTE: DATA statement used (Total process time):
      real time           0.23 seconds
      cpu time            0.21 seconds



