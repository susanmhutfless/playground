429  /********************************************************************
430  * Job Name: read_raw_puf_prescription.sas
431  * Job Desc: code to read raw txt which is puf prescription sample
432  * COPYRIGHT (c) 2019 2020 Johns Hopkins University - HutflessLab 2019
433  ********************************************************************/
434
435  %global  raw_data_path     ;
436  %global  raw_data_product  ;
437  %global  raw_product       ;
438  %let     raw_data_path     = C:\z_data\z_client_jhu\puf1\;
439  %let     raw_data_product  =DE1_0_2008_to_2010_Prescription_Drug_Events_Sample_1.csv ;
440  %let     raw_product       = &raw_data_path.&raw_data_product;
441
442  %global  perm_lib          ;
443  %global  lwork             ;
444  %global  out_ds            ;
445  %let     perm_lib          =ndcprod        ;
446  %let     lwork             =work           ;
447  %let     out_ds            =pat_prescript  ;
448
449  %global  pat_id   ;
450  %global  clm_id   ;
451  %global  srvc_dt  ;
452
453  %let     pat_id   =desynpuf_id  ;
454  %let     clm_id   =pde_id       ;
455  %let     srvc_dt  =srvc_dt      ;
456  %let     prod_id  =prod_srvc_id ;
457
458
459  %macro read_in_raw_to_get_sasds(raw_in_data   = ,
460                                  local_out_ds  =
461                                  );
462     data &local_out_ds ;
463         infile "&raw_in_data"
464         delimiter=',' MISSOVER DSD lrecl=32767 firstobs=2 ;
465
466         informat &pat_id                  $42. ; format &pat_id                  $42. ;
467         informat &clm_id                  $42. ; format &clm_id                  $42. ;
468         informat &srvc_dt          anydtdte21. ; format &srvc_dt            yymmdd10. ;
469         informat &prod_id                 $16. ; format &prod_id                 $16. ;
470         informat qty_dspnsd_num        best32. ; format qty_dspnsd_num       comma12.0;
471         informat days_suply_num        best32. ; format days_suply_num       comma12.0;
472         informat ptnt_pay_amt          best32. ; format ptnt_pay_amt         comma12.0;
473         informat tot_rx_cst_amt        best32. ; format tot_rx_cst_amt       comma12.0;
474      input
475                  &pat_id                $
476                  &clm_id                $
477                  &srvc_dt
478                  &prod_id               $
479                  qty_dspnsd_num
480                  days_suply_num
481                  ptnt_pay_amt
482                  tot_rx_cst_amt
483      ;
484      if &prod_id   in : ("OTHER",'other') then delete;
485      run;
486
487  %mend; *** end of read_in_raw_to_get_sasds ;
488
489
490  %read_in_raw_to_get_sasds(raw_in_data   = &raw_product,
491                            local_out_ds  = &perm_lib..&out_ds
492                            );

NOTE: The infile
      "C:\z_data\z_client_jhu\puf1\DE1_0_2008_to_2010_Prescription_Drug_Events_Sample_1.csv" is:
      Filename=C:\z_data\z_client_jhu\puf1\DE1_0_2008_to_2010_Prescription_Drug_Events_Sample_1.csv,
      RECFM=V,LRECL=32767,
      File Size (bytes)=425001860,
      Last Modified=26Nov2019:14:51:36,
      Create Time=13Dec2019:21:12:56

NOTE: 5552421 records were read from the infile
      "C:\z_data\z_client_jhu\puf1\DE1_0_2008_to_2010_Prescription_Drug_Events_Sample_1.csv".
      The minimum record length was 67.
      The maximum record length was 78.
NOTE: The data set NDCPROD.PAT_PRESCRIPT has 5552398 observations and 8 variables.
NOTE: DATA statement used (Total process time):
      real time           5.16 seconds
      cpu time            4.95 seconds


493
494
495
496  data &perm_lib..&out_ds   ;
497          set &perm_lib..&out_ds    ;
498              drop qty_:;
499              drop ptnt:;
500              drop days_:;
501              drop tot_:;
502              temp_id=&prod_id *1;
503  run;

NOTE: Character values have been converted to numeric values at the places given by: (Line):(Column).
      1:1
NOTE: There were 5552398 observations read from the data set NDCPROD.PAT_PRESCRIPT.
NOTE: The data set NDCPROD.PAT_PRESCRIPT has 5552398 observations and 5 variables.
NOTE: DATA statement used (Total process time):
      real time           1.34 seconds
      cpu time            1.04 seconds


504
505  proc sort data= &perm_lib..&out_ds    ;
506      by temp_id &srvc_dt ;
507  run;

NOTE: There were 5552398 observations read from the data set NDCPROD.PAT_PRESCRIPT.
NOTE: The data set NDCPROD.PAT_PRESCRIPT has 5552398 observations and 5 variables.
NOTE: PROCEDURE SORT used (Total process time):
      real time           2.17 seconds
      cpu time            4.03 seconds


